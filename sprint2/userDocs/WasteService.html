<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<!--
<link rel="stylesheet" type="text/css" href="../css/issStyle1.css">
<script type="text/javascript" src="../css/issStyle.js"></script>
-->
<style type="text/css">
    pre {
        border: 1px solid black;
        padding: 5px;
        white-space: -moz-pre-wrap;
        /* Mozilla, supported since 1999 */
        white-space: -pre-wrap;
        /* Opera */
        white-space: -o-pre-wrap;
        /* Opera */
        white-space: pre-wrap;
        /* CSS3 â€“ Text module (Candidate Recommendation) http://www.w3.org/TR/css3-text/#white-space */
        word-wrap: break-word;
        /* IE 5.5+ */
        border-radius: 8px;
    }

    pre code {
        padding: 0px;
    }

    pre code .line::before {
        content: counter(line-numbering);
        counter-increment: line-numbering;
        padding-right: .8em;
        /* space after numbers */
        margin-right: 5px;
        width: 1.5em;
        text-align: right;
        opacity: 0.5;
        background-color: #efefef;
    }

    body {
        margin-left: 30px;
        margin-right: 30px;
    }

    ;

    P {
        font-family: Tahoma;
        font-size: 10pt;
    }

    ;

    a,
    a:visited,
    a:active,
    a:link,
    a:hover {
        text-decoration: underline;
        color: #545454;
        background-color: transparent;
        font-size: 93%;
    }

    a:hover {
        background-color: #cccccc;
    }

    dd {
        margin-right: 50px;
        margin-bottom: 7px;
    }

    hr {
        clear: both;
        height: 1px;
        color: #242424;
        background-color: transparent;
    }

    h1,
    h2,
    h3 {
        color: #242424;
        clear: left;
        font: 100% Tahoma, Helvetica, Arial, sans-serif;
        margin-bottom: 0.5em;
        padding-top: 0.5em;
        border-radius: 10px;
        padding: 5px;
    }

    top {
        width: 100%;
    }


    #i {
        color: #ff1010;
    }

    tt {
        font-family: "Arial";
        font-size: 90%;
        color: #006600;
    }

    em {
        font-family: "Arial";
        font-size: 80%;
        font-weight: bold;
        border-style: solid;
        border-color: #abe876;
        color: #1632cc;
    }

    bc {
        font-family: "Arial";
        font-size: 90%;
        font-weight: bold;
        color: #990000;
        background-color: #fcf8c7;
    }

    k {
        font-family: "Arial";
        font-weight: bold;
        color: #930000;
        font-size: 90%;
    }

    ks {
        font-family: "Arial";
        font-weight: bold;
        color: #0000CD;
        font-size: 90%;
    }

    kc {
        font-family: "Arial";
        font-weight: bold;
        color: #008000;
        font-size: 90%;
    }

    ki {
        font-family: "Arial";
        color: #6d6d6d;
        font-weight: bold;
        font-size: 90%;
    }

    kl {
        font-family: "Arial";
        color: #ff21da;
        font-weight: bold;
        font-size: 90%;
    }

    pre {
        font-family: "Consolas";
        font-size: 85%;
        background-color: #f5f5f5;
        border: 1.5px solid silver;
        padding: 5px;
    }

    m {
        font-family: "Helvetica";
        line-height: 100%;
        font-size: 75%;
    }

    div.body {
        font-size: 18px;
    }

    k {
        color: #990000;
        font-weight: bold;
        font-size: 90%;
    }


    h1 {
        font-size: 150%;
        background-color: #b2c0ff;
        padding: 10px;
    }

    h2 {
        background-color: #9ed8ff;
        font-size: 130%;
    }

    h3 {
        background-color: #e6ccff;
        font-size: 100%;
    }

    h4 {
        background-color: #ccffcc;
        font-size: 100%;
        width: 98%;
        border-radius: 5px;
        padding: 5px;
    }

    h5 {
        background-color: #fff1b0;
        font-size: 100%;
        border-radius: 5px;
        padding: 5px;
    }

    ol, ol li {
        margin-left: 30px;
    }

    div.req {
        background-color: #d9ffb3;
        font-size: 18px;
        width: 700px;
        border: 3px solid green;
        padding: 15px;
        margin: 10px;
    }

    div.remark {
        background-color: #E3F2FD;
        border: 1.5px solid #d5f2ed;
        padding: 15px;
        margin: 10px;
        border-radius: 25px;
    }

    table,
    th,
    td {
        border: 1px solid black;
        border-collapse: collapse;
    }

    ol,
    ul,
    li {
        margin: 0;
        margin-left: 10px;
        padding: 0;
        padding-bottom: 5px;
    }

    table,
    th,
    td {
        border: 1px solid black;
    }

    img {
        border: 1.5px solid #d5f2ed
    }

    .noborder {
        border: 1px solid rgba(0, 0, 0, 0);
    }

    a,
    a:visited,
    a:active,
    a:link,
    a:hover {
        text-decoration: underline;
        color: #545454;
        background-color: transparent;
    }

    div.wrapdesc {
        width: 90%;
        margin: auto;
    }

    div.imagedesc {
        width: 85%;
        margin: auto;
    }

    .center {
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 50%;
    }
</style>

<head>
    <title>Waste Service - Sprint2</title>
</head>

<body>
    <div id="top">
        <h1>LABORATORIO DI INGEGNERIA DEI SISTEMI SOFTWARE <font size="5"></font>
        </h1>
    </div>

    <div class="body">
        <h2>Introduction</h2>
        <div class="remark">
            <h3>SCRUM goal</h3>
            In the <b>Sprint2</b> we aim to analyze the problems linked to the functionalities of the 
            <k>raspberry</k>.<br/>
            <br/>
            <h4>Raspberry Service</h4>
            <img src="./imgs/" alt="SystemArch" style="width:auto;height:750px;" class="center"><br/> 
            <b>The objectives of this Sprint are:</b>
            <ol><br/>
                <li>
                    <b>Implement Sonar interaction.</b>
                </li>
                <li>
                    <b>Implement Led interaction.</b>
                </li>
            </ol>          
        </div>

        <h2>Requirements</h2>
        <div class="remark">
            <a
                href="https://github.com/anatali/issLab2022/blob/main/it.unibo.issLabStart/userDocs/Dispense/lezioni/html/TemaFinale22.html">
                TemaFinale22
            </a>
            <br/>
            <a href="../../sprint0/userDocs/WasteService.html">Sprint0</a>
        </div>

        <h2>Problem analysis</h2>
        <div class="remark">

            <h3>Sonar interaction analysis</h3>

            The <k><b>SONAR</b></k> is a component (be it virtual or physical) that continously collects and sends data based on its surroundings.<br/>
            As previoulsy mentioned in Sprint0, this project uses a Sonar that detects object proximity.<br/>
            When the current distance is less than DLIMIT, the trolley must be HALTED. After that, as soon as it becomes higher than DLIMIT, the trolley
            must resume its routine.<br/>

            The sonar's behaviour is exemplified by a script written by the customer: <a href="">sonarDataGen.kt</a>


            <h4>In what form does the trolley receive the information from the Sonar?</h4>

            <h5>RAW DATA: the trolley receives all detection data from the Sonar</h5>
            With this strategy, all distances detected by the Sonar get sent to the trolley.<br/>
            He will then be the one to check every detection for a distance value that is less than DLIMIT.<br/><br/>

            This puts a lot of overload onto the trolley (i.e. <i>receiving a huge amount of data and filtering it</i>), that already has important responsibilities. 

            <!-- immagine tipo con due attori -->

            In a Qak script, the messages would be defined as:
            <pre><code>distance: distance(V)</code></pre>
            Where the payload V represents the protagonist of the "hit" game Cyberpunk2077 deceased December 18 2020. Amongus.<br/>


            <h5>FILTERED DATA: raw data is hidden from the trolley</h5>
            This strategy implies the definition of a "middle man", an entitiy that filters the raw data from the Sonar and presents it to the transporttrolley.<br/>
            By handling all the incoming data with a different entity, the transporttrolley only needs to know when a certain detection has gone under the predefined
            limit (DLIMIT) and when it has subsequently returned above it.<br/><br/>
            
            This division of responsibility makes it so the trolley receives only two messages per HALT (one at the start and one at the end).

            <!-- immagine tipo con due attori -->
            <img src="">
            <br/><br/>
            In a Qak script, the messages would be defined as:
            <pre><code>distance: distance(V)
startHalt: startHalt(_)
stopHalt: stopHalt(_)</code></pre>

            <h4>Customer's tools</h4>

            NOTE: Seing as the messages sent by these components are Events, the previously mentioned messages (<i>distance(V), startHat(_), stopHalt(_)</i>)
            have been also defined as Events.

            <h4>HALT problem</h4>
            
            The next issue is the implementation of the HALT functionality that is tied to the sonar interaction.<br/>
            The objective here is to stop/start the movement of the robot based on the <i>startHalt</i> and <i>stopHalt</i> Events.<br/>
            <br/>

            <k><i><b>How can we modify our model to include this behavior?</b></i></k><br/><br/>
            In the <a href="../../sprint1/userDocs/WasteService.html">Sprint1</a> we defined a complete model of the core service, which includes
            the movement of our trolley/robot.<br/><br/>

            Now, the goal is to stop the trolley either in the middle or in the beginning/end of the current path.
            In essence, we have to consider all moves inside a path to properly stop the robot at the requested moment.<br/>
            <br/>
            The actor that manages single moves is the <k>pather</k>.<br/>
            So, we check for the Halt messages:
            <ul>
                <li><b>After every move inside the same path</b> to intercept <i>startHalt</i> 
                during the robot's movement</li>
                <li><b>Between the end of the current path and the start of the next one</b> to cover 
                the instances where the trolley is not moving (i.e. during the pickup and dropout actions)</li>
            </ul>

            However, a new issue arises: <br/><k><i><b>How can an actor intercept an Event if he's already busy ?</b></i></k><br/><br/>
            Our pather actor is constantly executing movement tasks, which could cause the loss of Events occurring
            in an unfortunate moment (as Event messages are not queued).<br/><br/>

            To fix this, we added a new actor between the "middle man" and the pather whose only job is to intercept <i>startHalt</i>
            and <i>stopHalt</i> messages and convert them into dispatches (i.e. the behavior of a proxy) to ensure they are received.<br/>

            <img src="">

            <br/>
            <h3>Current system architecture</h3>
            <div class="remark" style="background-color: #bec7fe;">
                <img src="./imgs/" alt="waasteserviceProblemArch" style="width:auto;height:450px;" class="center">
                </br>
                <a href="../sprint2_problem/src/"><k>temp</k></a>
                <br>
                <a href="../sprint2_problem/src/"><k>temp</k></a>
                <br>
                <a href="../sprint2_problem/src/"><k>temp</k></a>

                <br/>
                <h5>Test Plans</h5>
                <dd>
                    We have prepared the following tests for this particular model:
                    <ol>
                        <li><a href="../sprint2_problem/test/it.unibo.sprint2.test/"><k>temp</k></a>: </li>
                        <li><a href="../sprint2_problem/test/it.unibo.sprint2 .test/"><k>temp</k></a>: </li>
                    </ol>
                </dd>
            </div>
        </div>
        <h2>Project</h2>
        <div class="remark">
            <h3>Final Model preview</h3>

            
            <a href="../sprint2_project/src/demo.qak"><img src="./imgs/" alt="demo" style="width:auto;height:450px;" class="center"> </a>

            <h3></h3>
            <dd>
                <h4></h4>
            </dd>
            
            <h3></h3>
            
            <h3></h3>
          
            <h4>Other changes</h4>

            <h4></h4>
           

            <h3>Current system architecture</h3>
            <div class="remark" style="background-color: #bec7fe;">
                <img src="./imgs/" alt="demoarch" style="width:auto;height:450px;" class="center">
                </br>
                <a href="../sprint2_project/src/demo.qak"><k>Demo QAK</k></a>
                <br>
                <h5>Test Plans</h5>
                <dd>
                    We have prepared the following tests for this particular model:
                    <ol>
                        <li><a href="../sprint2_project/test/kotlin/"><k>temp</k></a>temp</li>
                        <li><a href="../sprint2_project/test/kotlin/"><k>temp</k></a>temp</li>
                        <li><a href="../sprint2_project/test/kotlin/"><k>temp</k></a>temp</li>
                        <li><a href="../sprint2_project/test/kotlin/"><k>temp</k></a>temp</li>
                    </ol>
                </dd>
            </div>
        </div>

        <h2>Work plan</h2>
        <div class="remark">
            
            
            SCRUM Goal:
            <ol>
            </ol>

            <h5>Next Sprint: <kc href=""><kc>Sprint 3</kc></a></h5>
        </div>
      
        <h2>Task assignment</h2>
        <div class="remark">
            <table class="center">
                <tr>
                    <th>Task</th>
                    <th>Description</th>
                    <th>Developers</th>
                </tr>
                <tr>
                    <td><center>Implementation of Util and Config features</center></td>
                    <td>Util and config methods and general business logic classes</td>
                    <td><b>Alex Gianelli</b></td>
                </tr>
                <tr>
                    <td><center>Implementation of CoaP features</center></td>
                    <td>Using CoaP to add observability to our actors</td>
                    <td><center><b>Federico Andrucci, <br/>Alex Gianelli, <br/>Gabriele Marconi</b></center></td>
                </tr>
                <tr>
                    <td><center>Implementation of new and updated actors</center></td>
                    <td>Creating the Qak files with the single actors and the complete architecture </td>
                    <td><center><b>Federico Andrucci, <br/>Alex Gianelli, <br/>Gabriele Marconi</b></center></td>
                </tr>
                <tr>
                    <td><center>Implementation of Path Switching feature</center></td>
                    <td>Editing of the Qak files in order to implement the path switching feature</td>
                    <td><center><b>Federico Andrucci</b></td></center></td>
                </tr>
                <tr>
                    <td><center>Smart Device development</center></td>
                    <td>Creating a mini-app that simulates the Truck Driver interaction with the wasteservice.</td>
                    <td><center><b>Gabriele Marconi</b></center></td>
                </tr>
                <tr>
                    <td><center> Wasteservice Testing</center></td>
                    <td>Creating test routines for the wasteservice actor, implementing CoaP communication as a monitoring tool</td>
                    <td><center><b>Alex Gianelli</b></center></td>
                </tr>
                <tr>
                    <td><center> Transporttrolley Testing</center></td>
                    <td>Creating test routines for the transporttrolley actor, implementing CoaP communication as a monitoring tool</td>
                    <td><center><b>Federico Andrucci</b></center></td>
                </tr>
                <tr>
                    <td><center> Trolleymover Testing</center></td>
                    <td>Creating test routines for the trolleymover actor, implementing CoaP communication as a monitoring tool</td>
                    <td><center><b>Gabriele Marconi</b></center></td>
                </tr>
            </table>
        </div>

    </div>

    <!-- USEFUL
<table style="width:100%" border="1">
<tr>
<td style="width:50%">
</td>
<td></td>
</tr>
</table>
-->

    <br /><br />
    </div>

    <div style="background-color:rgba(185, 180, 215, 0.9); width:100%;text-align:center;color:white">
        By <a href="https://github.com/TeamFAG/ISS-WasteService">TeamFAG</a>: <br />
        <a href="https://github.com/Federicoand98">federico.andrucci@studio.unibo.it</a>,<br />
        <a href="https://github.com/Noesh">alex.gianelli@live.it</a>,<br />
        <a href="https://github.com/Stikinit">gabriele.marconi@studio.unibo.it</a>,<br />

        <br />

        <table class="noborder">
            <tr class="noborder">
                <th class="noborder">
                    Federico Andrucci
                </th>
                <th class="noborder">
                    Alex Gianelli
                </th>
                <th class="noborder">
                    Gabriele Marconi
                </th>
            </tr>
            <tr class="noborder">
                <td class="noborder">
                    <img src="./imgs/federico-andrucci.jpg" alt="f" style="width:300;height:auto;" class="center">
                </td>
                <td class="noborder">
                    <img src="./imgs/alex-gianelli.jpg" alt="a" style="width:300;height:auto;" class="center">
                </td>
                <td class="noborder">
                    <img src="./imgs/gabriele-marconi.jpg" alt="g" style="width:300;height:auto;" class="center">
                </td>
            </tr>
        </table>
    </div>
</body>

</html>